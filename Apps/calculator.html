<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=SF+Pro+Display:wght@300;400;500;600&display=swap"
            rel="stylesheet"
        />
        
        <title>Calculator</title>
        <link rel="stylesheet" href="cal_styles.css">
    </head>
    <body>
        <header class="main-header">
            <h2 class="set-subtitles-font">Calculator</h2>
        </header>

        <textarea name="num" class="text-area">0</textarea>
        <div class="calc">
            
            <button class="grey_but">AC</button>
            <button class="grey_but">+/-</button>
            <button class="grey_but">%</button>
            <button class="orange_but"><i class="fa-solid fa-divide"></i></button>
            <button class="dark_but">7</button>
            <button class="dark_but">8</button>
            <button class="dark_but">9</button>
            <button class="orange_but"><i class="fa-solid fa-xmark"></i></button>
            <button class="dark_but">4</button>
            <button class="dark_but">5</button>
            <button class="dark_but">6</button>
            <button class="orange_but"><i class="fa-solid fa-minus"></i></button>
            <button class="dark_but">1</button>
            <button class="dark_but">2</button>
            <button class="dark_but">3</button>
            <button class="orange_but"><i class="fa-solid fa-plus"></i></button>
            <button class="dark_but"><i class="fa-solid fa-calculator"></i></button>
            <button class="dark_but">0</button>
            <button class="dark_but">,</button>
            <button class="orange_but"><i class="fa-solid fa-equals"></i></button>
        </div>

        <script>
            const calc = document.querySelector(".calc");
            let current = "";       
            let previous = "";      
            let operator = "";      

            function updateDisplay() {
                // Si tienes un display, lo actualizas aquÃ­.
                // Si no tienes display, te puedo ayudar a crearlo.
                console.log(current || previous || "0");
            }

            function calculate() {
                const num1 = parseFloat(previous);
                const num2 = parseFloat(current);
                if (isNaN(num1) || isNaN(num2)) return;

                switch (operator) {
                    case "+": previous = (num1 + num2).toString(); break;
                    case "-": previous = (num1 - num2).toString(); break;
                    case "x": previous = (num1 * num2).toString(); break;
                    case "DIV": previous = (num1 / num2).toString(); break;
                }
            }

            calc.addEventListener("click", (e) => {
                if (e.target.tagName !== "BUTTON") return;
                const value = e.target.textContent;

                if (!isNaN(value)) {
                    current += value;
                    updateDisplay();
                    return;
                }

                if (["+", "-", "x", "DIV"].includes(value)) {
                    if (current === "") return;

                    if (previous && operator) {
                        calculate();
                    } else {
                        previous = current;
                    }

                    operator = value;
                    current = "";
                    updateDisplay();
                    return;
                }

                if (value === "=") {
                    if (!current || !operator) return;
                    calculate();
                    current = "";
                    operator = "";
                    updateDisplay();
                    return;
                }

                if (value === "AC") {
                    current = "";
                    previous = "";
                    operator = "";
                    updateDisplay();
                    return;
                }

                if (value === "+/-") {
                    if (current) {
                        current = (parseFloat(current) * -1).toString();
                    } else if (previous) {
                        previous = (parseFloat(previous) * -1).toString();
                    }
                    updateDisplay();
                    return;
                }

                if (value === "%") {
                    if (current) {
                        current = (parseFloat(current) / 100).toString();
                    }
                    updateDisplay();
                    return;
                }

                if (value === "," && !current.includes(".")) {
                    current += ".";
                    updateDisplay();
                    return;
                }
            });
        </script>
        
    </body>
</html>